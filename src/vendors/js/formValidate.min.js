function formValidate(e){new validateForm(e)}let globalVars={counter:0,inputFirst:!1,labelFirst:!1,inputsArray:[],amountFiles:0};function reloadFiles(e){let t=e.form,l=e.target,r=t.querySelectorAll('input[type="file"]'),i=!1,s="",a="";r[0].files[0]&&r[0].classList.remove("error");let o=document.createElement("label");r[0].getAttribute("data-role").includes("required")&&(i=!0);let n=r[r.length-1];l.nextElementSibling&&"LABEL"===l.nextElementSibling.tagName?(a=e.addText?e.addText:l.nextElementSibling.innerHTML,o=l.nextElementSibling,s=l.files[0].name,globalVars.inputFirst=!0):l.previousElementSibling&&"LABEL"===l.previousElementSibling.tagName?(o=l.previousElementSibling,a=e.addText?e.addText:l.previousElementSibling.innerHTML,globalVars.labelFirst=!0,s=l.files[0].name,n.files[0]=""):console.log("Structure error. Must be <input><label> or <label><input>"),o.innerHTML=s,globalVars.counter=++globalVars.counter;let u=r[0].getAttribute("id"),m=r[0].getAttribute("name"),b=document.createElement("input");b.setAttribute("name",m),b.setAttribute("type","file"),b.setAttribute("data-role","file");let d=b.getAttribute("name"),h=String(globalVars.counter)+d,p=(b.getAttribute("id"),String(globalVars.counter)+u);if(b.setAttribute("ID",p),b.setAttribute("name",h),globalVars.inputFirst&&globalVars.amountFiles<=e.limit){l.after(o),o.after(b);let r=document.createElement("label");if(r.innerHTML=a,r.setAttribute("for",p),b.after(r),globalVars.amountFiles=++globalVars.amountFiles,globalVars.amountFiles===e.limit){let e=t.querySelectorAll('input[type="file"]');e[e.length-1].setAttribute("disabled","")}}else if(globalVars.labelFirst&&globalVars.amountFiles<=e.limit){let r=document.createElement("label");if(r.setAttribute("for",p),r.innerHTML=a,l.after(r),l.nextElementSibling.after(b),globalVars.amountFiles=++globalVars.amountFiles,globalVars.amountFiles===e.limit){let e=t.querySelectorAll('input[type="file"]');e[e.length-1].setAttribute("disabled","")}}r.forEach(l=>{globalVars.inputsArray.includes(l)||(globalVars.inputsArray.push(l),l.addEventListener("click",s=>{globalVars.inputFirst&&s.target.files&&(s.preventDefault(),l.nextElementSibling&&l.nextElementSibling.remove(),delete l.files[0],l.remove(),globalVars.amountFiles=--globalVars.amountFiles,globalVars.amountFiles===e.limit?t.querySelectorAll('input[type="file"]')[t.querySelectorAll('input[type="file"]').length-1].setAttribute("disabled",""):t.querySelectorAll('input[type="file"]')[t.querySelectorAll('input[type="file"]').length-1].removeAttribute("disabled","")),globalVars.labelFirst&&s.target.files&&(globalVars.inputsArray.includes(l)||globalVars.inputsArray.push(l),s.preventDefault(),l.previousElementSibling&&l.previousElementSibling.remove(),delete l.files[0],l.remove(),globalVars.amountFiles=--globalVars.amountFiles,globalVars.amountFiles===e.limit?t.querySelectorAll('input[type="file"]')[t.querySelectorAll('input[type="file"]').length-1].setAttribute("disabled",""):t.querySelectorAll('input[type="file"]')[t.querySelectorAll('input[type="file"]').length-1].removeAttribute("disabled","")),1===r.length&&i&&t.querySelectorAll('input[type="file"]')[0].setAttribute("data-role","file required")}))})}class validateForm{constructor(e){this.form=e.form,this.length=e.form.children.length,this.errors=[],this.passwordRegExp=e.passwordRegEx||/^.{6,}$/,this.emailRegExp=e.emailRegExp||/^[-._a-zA-Z0-9]+@(?:[a-z0-9][-a-z0-9]+\.)+[a-z]{2,6}$/,this.phoneRegExp=e.phoneRegExp||/^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){6,14}(\s*)?$/,this.url=e.url,this.onLoadStart=e.onLoadStart||(()=>{}),this.onSuccess=e.onSuccess||(()=>{}),this.onError=e.onError||(()=>{}),this.errorClass=e.errorClass||"error",this.customFields=e.customFields||[],this.data=null,this.error=null,this.validation()}validation(){this.errors=[];let e=this.form.querySelectorAll("input");for(let t=0;t<e.length;t++){if("button"===e[t].type||"submit"===e[t].type)continue;let l=e[t].getAttribute("data-role").includes("required");l&&""===e[t].value||l&&e[t].getAttribute("data-role").includes("checkbox")&&!e[t].checked?this.errors.push(e[t]):e[t].getAttribute("data-role").includes("phone")?this.phoneValidation(e[t]):e[t].getAttribute("data-role").includes("email")?this.emailValidation(e[t]):e[t].getAttribute("data-role").includes("password")?this.passwordValidation(e[t]):e[t].classList.remove(this.errorClass);for(let l=0;l<this.customFields.length;l++)e[t].getAttribute("data-role").includes(this.customFields[l].dataRole)&&this.customFieldValidation(e[t],this.customFields[l].regExp)}if(this.errors.length)this.errors.forEach(e=>(e.classList.add(this.errorClass),!1));else{let t=!1;e.forEach(e=>{if(e.classList.contains("error"))return t=!0,!1}),t||this.sendInfo(this.url)}}customFieldValidation(e,t){return e.value.match(t)?(e.classList.remove(this.errorClass),this.errors.pop(e),!0):(this.errors.push(e),e.classList.add(this.errorClass),!1)}phoneValidation(e){return e.value.match(this.phoneRegExp)?(e.classList.remove(this.errorClass),!0):(this.errors.push(e),!1)}emailValidation(e){return e.value.match(this.emailRegExp)?(e.classList.remove(this.errorClass),!0):(this.errors.push(e),!1)}passwordValidation(e){return e.value.match(this.passwordRegExp)?(e.classList.remove(this.errorClass),!0):(this.errors.push(e),!1)}cleanForm(){if(this.form.reset(),this.form.querySelector('input[type="file"]')){let e=this.form.querySelector('input[type="file"]'),t=(e.cloneNode(!1),this.form.querySelectorAll('input[type="file"]'));e.previousElementSibling;for(let e=0;e<t.length-1;e++)globalVars.labelFirst?(t[e].previousElementSibling.remove(),t[e].remove()):(t[e].nextElementSibling.remove(),t[e].remove());this.form.querySelectorAll('input[type="file"]')[form.querySelectorAll('input[type="file"]').length-1].removeAttribute("disabled",""),globalVars.inputFirst&&(this.form.querySelectorAll('input[type="file"]').nextElementSibling.innerHTML=""),globalVars.inputsArray=[],globalVars.amountFiles=0,globalVars.counter=0}}sendInfo(e){let t=new FormData(this.form);this.form.querySelector('button[type="submit"]').setAttribute("disabled",""),this.onLoadStart(),fetch(e,{method:"post",body:t}).then(e=>e.json()).then(e=>{this.data=e,this.onSuccess(),this.cleanForm(),this.form.querySelector('button[type="submit"]').removeAttribute("disabled")}).catch(e=>{this.error=e,this.onError(),this.form.querySelector('button[type="submit"]').removeAttribute("disabled")})}}